(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{NWbE:function(e,t,o){"use strict";o.r(t),o.d(t,"LessonsModule",function(){return N});var s=o("ofXK"),n=o("PCNd"),i=o("tyNb"),r=o("fXoL"),c=o("3Pt+"),l=o("J7/z"),a=o("WR8Z"),d=o("dJ3e"),b=o("zFJ7"),h=o("upuz");function u(e,t){if(1&e){const e=r.Rb();r.Ob(0),r.Qb(1,"div",18),r.Qb(2,"h6",19),r.Hc(3,"Do you want to add additional homework?"),r.Pb(),r.Qb(4,"div",20),r.Qb(5,"div",21),r.Qb(6,"input",22),r.Xb("change",function(){return r.yc(e),r.bc().toggleAdditionalHomework(!0)}),r.Pb(),r.Qb(7,"label",23),r.Hc(8,"Yes"),r.Pb(),r.Pb(),r.Qb(9,"div",24),r.Qb(10,"input",25),r.Xb("change",function(){return r.yc(e),r.bc().toggleAdditionalHomework(!1)}),r.Pb(),r.Qb(11,"label",26),r.Hc(12,"No"),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Nb()}2&e&&(r.yb(6),r.ic("value",!0),r.yb(4),r.ic("value",!1))}function f(e,t){if(1&e){const e=r.Rb();r.Ob(0),r.Qb(1,"div",33),r.Qb(2,"input",34),r.Xb("change",function(){r.yc(e);const t=r.bc(2);return t.showBonus=!t.showBonus}),r.Pb(),r.Qb(3,"label",35),r.Hc(4,"Bonus"),r.Pb(),r.Pb(),r.Nb()}}function p(e,t){1&e&&(r.Qb(0,"div",36),r.Qb(1,"p",8),r.Hc(2,"Bonus Points"),r.Pb(),r.Lb(3,"input",37),r.Pb())}function m(e,t){if(1&e&&(r.Qb(0,"div",5),r.Qb(1,"div",6),r.Qb(2,"div",27),r.Qb(3,"div",18),r.Qb(4,"p",8),r.Hc(5,"Question Text"),r.Pb(),r.Lb(6,"input",28),r.Pb(),r.Pb(),r.Pb(),r.Qb(7,"div",6),r.Qb(8,"div",29),r.Qb(9,"p",8),r.Hc(10,"Min No of Characters"),r.Pb(),r.Lb(11,"input",30),r.Pb(),r.Qb(12,"div",29),r.Qb(13,"p",8),r.Hc(14,"No. of Max Points"),r.Pb(),r.Lb(15,"input",31),r.Pb(),r.Qb(16,"div",29),r.Qb(17,"div",6),r.Fc(18,f,5,0,"ng-container",13),r.Fc(19,p,4,0,"div",32),r.Pb(),r.Pb(),r.Pb(),r.Pb()),2&e){const e=r.bc();r.yb(18),r.ic("ngIf",!e.config.data.lesson.viewMode),r.yb(1),r.ic("ngIf",e.showBonus||e.config.data.lesson.report.homework.bonusPoints)}}function g(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",38),r.Xb("click",function(){return r.yc(e),r.bc().clicked()}),r.Hc(1,"Submit "),r.Qb(2,"span",39),r.Lb(3,"i",40),r.Pb(),r.Pb()}}const w=function(){return[]};let v=(()=>{class e{constructor(e,t,o,s,n){this.formBuilder=e,this.activeModal=t,this.teacherService=o,this.config=s,this.alertService=n,this.additionalHomework=!1,this.lessonInstanceStudents=[],this.absents=[],this.missedHomework=[],this.studentsIds=[],this.students=[],this.clonedStudents=[],this.showBonus=!1,this.btnClicked=!1,this.attendSwitchedStudents=[],this.homeWorkSwitchedStudents=[],this.lessonReport=new Object}ngOnInit(){this.loadForm(),this.config.data.lesson.viewMode?(this.students=this.config.data.lesson.report.lessonInstanceStudents,this.clonedStudents=JSON.parse(JSON.stringify(this.students)),this.config.data.lesson.materialDone&&(this.form.controls.lessonDoneField.setValue(this.config.data.lesson.materialDone),this.form.controls.lessonDoneField.disable()),this.config.data.lesson.materialToDo&&(this.form.controls.toDoField.setValue(this.config.data.lesson.materialToDo),this.form.controls.toDoField.disable()),this.config.data.lesson.report.homework&&(this.toggleAdditionalHomework(!0),this.config.data.lesson.report.homework.text&&(this.form.controls.questionTextField.setValue(this.config.data.lesson.report.homework.text),this.form.controls.questionTextField.disable()),this.config.data.lesson.report.homework.minCharacters&&(this.form.controls.minCharsField.setValue(this.config.data.lesson.report.homework.minCharacters),this.form.controls.minCharsField.disable()),this.config.data.lesson.report.homework.points&&(this.form.controls.pointsField.setValue(this.config.data.lesson.report.homework.points),this.form.controls.pointsField.disable()),this.config.data.lesson.report.homework.bonusPoints&&(this.form.controls.bonusPointsField.setValue(this.config.data.lesson.report.homework.bonusPoints),this.form.controls.bonusPointsField.disable())),this.setStudentViewMode()):this.teacherService.getLessonReportStudents(this.config.data.lesson.id).subscribe(e=>{this.students=e.data,this.clonedStudents=JSON.parse(JSON.stringify(this.students))})}loadForm(){this.form=this.formBuilder.group({lessonDoneField:"",toDoField:"",additionalHomeworkField:!1,questionTextField:"",minCharsField:"",pointsField:"",bonusPointsField:""})}getAbsents(e){this.absents=[];for(let t of e)this.absents.push(t)}getMissedHomework(e){this.missedHomework=[];for(let t of e)this.missedHomework.push(t)}getLessonInstanceStudents(){this.studentsIds=[],this.lessonInstanceStudents=[];for(let t of this.absents)this.studentsIds.push(t);for(let t of this.missedHomework)this.studentsIds.push(t);let e=[...new Set(this.studentsIds)];for(let t of e){let e=t.split("?")[0],o=t.split("?").pop();this.absents.includes(t)&&this.missedHomework.includes(t)?this.lessonInstanceStudents.push({studentId:e,id:o,lessonInstanceId:this.config.data.lesson.id,attend:!1,homework:!1}):this.absents.includes(t)&&!this.missedHomework.includes(t)?this.lessonInstanceStudents.push({studentId:e,id:o,lessonInstanceId:this.config.data.lesson.id,attend:!1,homework:!0}):this.lessonInstanceStudents.push({studentId:e,id:o,lessonInstanceId:this.config.data.lesson.id,attend:!0,homework:!1})}}toggleAdditionalHomework(e){this.additionalHomework=e}createReport(){this.btnClicked&&(this.lessonReport.id=parseInt(this.config.data.lesson.id),this.lessonReport.materialDone=this.form.controls.lessonDoneField.value,this.lessonReport.materialToDo=this.form.controls.toDoField.value,this.lessonReport.isAdditionalHomework=this.form.controls.additionalHomeworkField.value,this.getLessonInstanceStudents(),this.lessonReport.lessonInstanceStudent=this.lessonInstanceStudents,this.lessonReport.isAdditionalHomework&&(this.lessonReport.additionalHomework=new Object,this.lessonReport.additionalHomework.text=this.form.controls.questionTextField.value,this.lessonReport.additionalHomework.minCharacters=this.form.controls.minCharsField.value,this.lessonReport.additionalHomework.points=this.form.controls.pointsField.value,this.lessonReport.additionalHomework.bonusPoints=this.form.controls.bonusPointsField.value?parseInt(this.form.controls.bonusPointsField.value):0),this.teacherService.submitLessonReport(this.lessonReport).subscribe(e=>{this.alertService.newAlert("success","Report Created Successfully"),this.close(!0)})),this.btnClicked=!1}clicked(){this.btnClicked=!0}close(e){this.activeModal.close(e)}setStudentViewMode(){this.students.forEach(e=>{e.attend||this.attendSwitchedStudents.push(e.student)}),this.clonedStudents.forEach(e=>{e.homework||this.homeWorkSwitchedStudents.push(e.student)})}}return e.\u0275fac=function(t){return new(t||e)(r.Kb(c.e),r.Kb(l.d),r.Kb(a.a),r.Kb(l.b),r.Kb(d.a))},e.\u0275cmp=r.Eb({type:e,selectors:[["app-lessons-report"]],decls:28,vars:13,consts:[[1,"report-header"],[1,"text-primary","font-weight-bold"],[1,"text-secondary","font-weight-bold"],[1,"font-weight-bold"],[3,"formGroup","click"],[1,"container"],[1,"row"],[1,"col-md-6"],[1,"text-secondary"],["autocomplete","off","placeholder","Type What Done in The Lesson","pInputTextarea","","formControlName","lessonDoneField",1,"adler-textarea",3,"disabled"],["title","Attendance","leftSideTitle","Absents Students List",3,"switchedStudents","viewMode","students","getSwitched"],["autocomplete","off","placeholder","Type What To Do Next Time","pInputTextarea","","formControlName","toDoField",1,"adler-textarea"],["title","Normal Homework","leftSideTitle","Missed Homework",3,"switchedStudents","viewMode","students","getSwitched"],[4,"ngIf"],["class","container",4,"ngIf"],[1,"col-md-12","mt-5"],["type","submit","class","btn adler-btn font-weight-bold mr-3",3,"click",4,"ngIf"],["type","button",1,"btn","outlined-adler-btn","btn-adler-sm","font-weight-bold",3,"click"],[1,"col-md-12","mt-3"],[1,"text-capitalize","font-weight-bold"],[1,"mt-3"],[1,"form-check","form-check-inline","mr-5"],["autocomplete","off","formControlName","additionalHomeworkField","type","radio","name","additionalHomeworkField","id","inlineRadio1",1,"form-check-input",3,"value","change"],["for","inlineRadio1",1,"form-check-label","font-weight-bold","text-secondary"],[1,"form-check","form-check-inline","ml-5"],["autocomplete","off","formControlName","additionalHomeworkField","type","radio","name","additionalHomeworkField","id","inlineRadio2",1,"form-check-input",3,"value","change"],["for","inlineRadio2",1,"form-check-label","font-weight-bold","text-secondary"],[2,"width","100%"],["autocomplete","off","required","","name","question-text","formControlName","questionTextField","type","text","id","questionText","placeholder","Question Text",1,"form-control","adler-form-control"],[1,"col-md-4"],["autocomplete","off","required","","name","min-chars","formControlName","minCharsField","type","text","id","minChars","placeholder","Min No of Characters",1,"form-control","adler-form-control"],["autocomplete","off","required","","name","points","formControlName","pointsField","type","text","id","points","placeholder","No. of Max Points",1,"form-control","adler-form-control"],["class","col-md-9",4,"ngIf"],[1,"col-md-3","pt-5"],["autocomplete","off","type","checkbox","name","bonusCheckbox","id","bonusCheckbox",1,"form-check-input",3,"change"],["for","bonus"],[1,"col-md-9"],["autocomplete","off","required","","name","bonusPoints","formControlName","bonusPointsField","type","text","id","bonusPoints","placeholder","Bonus",1,"form-control","adler-form-control"],["type","submit",1,"btn","adler-btn","font-weight-bold","mr-3",3,"click"],[1,"ml-4"],[1,"fas","fa-arrow-right"]],template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"h5",1),r.Hc(2,"Create Lesson Report"),r.Pb(),r.Qb(3,"h5",2),r.Hc(4,"Lesson 4"),r.Pb(),r.Qb(5,"p",3),r.Hc(6,"17 Dec 2020"),r.Pb(),r.Pb(),r.Qb(7,"form",4),r.Xb("click",function(){return t.createReport()}),r.Qb(8,"div",5),r.Qb(9,"div",6),r.Qb(10,"div",7),r.Qb(11,"p",8),r.Hc(12,"What Done in The Lesson"),r.Pb(),r.Lb(13,"textarea",9),r.Qb(14,"switch-list",10),r.Xb("getSwitched",function(e){return t.getAbsents(e)}),r.Pb(),r.Pb(),r.Qb(15,"div",7),r.Qb(16,"p",8),r.Hc(17,"To Do Next Time"),r.Pb(),r.Lb(18,"textarea",11),r.Qb(19,"switch-list",12),r.Xb("getSwitched",function(e){return t.getMissedHomework(e)}),r.Pb(),r.Pb(),r.Fc(20,u,13,2,"ng-container",13),r.Pb(),r.Pb(),r.Fc(21,m,20,2,"div",14),r.Qb(22,"div",5),r.Qb(23,"div",6),r.Qb(24,"div",15),r.Fc(25,g,4,0,"button",16),r.Qb(26,"button",17),r.Xb("click",function(){return t.close()}),r.Hc(27,"Cancel"),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb()),2&e&&(r.yb(7),r.ic("formGroup",t.form),r.yb(6),r.ic("disabled",!0),r.yb(1),r.ic("switchedStudents",t.config.data.lesson.viewMode?t.attendSwitchedStudents:r.lc(11,w))("viewMode",!(null==t.config||null==t.config.data||null==t.config.data.lesson||!t.config.data.lesson.viewMode)&&t.config.data.lesson.viewMode)("students",null!=t.config&&null!=t.config.data&&null!=t.config.data.lesson&&t.config.data.lesson.viewMode?t.config.data.lesson.report.lessonInstanceStudents:t.students),r.yb(5),r.ic("switchedStudents",t.config.data.lesson.viewMode?t.homeWorkSwitchedStudents:r.lc(12,w))("viewMode",!(null==t.config||null==t.config.data||null==t.config.data.lesson||!t.config.data.lesson.viewMode)&&t.config.data.lesson.viewMode)("students",null!=t.config&&null!=t.config.data&&null!=t.config.data.lesson&&t.config.data.lesson.viewMode?t.config.data.lesson.report.lessonInstanceStudents:t.clonedStudents),r.yb(1),r.ic("ngIf",!t.config.data.lesson.viewMode),r.yb(1),r.ic("ngIf",t.additionalHomework),r.yb(4),r.ic("ngIf",!t.config.data.lesson.viewMode))},directives:[c.y,c.q,c.i,c.b,b.a,c.p,c.g,h.a,s.m,c.u,c.w],styles:[".report-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:inline-block;color:#b2afaf}.report-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{display:inline-block;margin-right:3rem}"]}),e})();var P=o("QGev"),k=o("arFO");function y(e,t){1&e&&(r.Qb(0,"label"),r.Hc(1,"Teacher Name"),r.Pb())}function I(e,t){if(1&e){const e=r.Rb();r.Ob(0),r.Qb(1,"div",7),r.Qb(2,"p-autoComplete",8),r.Xb("ngModelChange",function(t){return r.yc(e),r.bc().selectedTeacher=t})("completeMethod",function(t){return r.yc(e),r.bc().searchTeacher(t)})("onSelect",function(){r.yc(e);const t=r.bc();return t.getTeacherGroup(t.selectedTeacher.teacherId)}),r.Pb(),r.Pb(),r.Nb()}if(2&e){const e=r.bc();r.yb(2),r.ic("ngModel",e.selectedTeacher)("suggestions",e.suggestedTeacher)("dropdown",!1)("forceSelection",!0)}}function Q(e,t){if(1&e){const e=r.Rb();r.Ob(0),r.Qb(1,"p-dropdown",9),r.Xb("ngModelChange",function(t){return r.yc(e),r.bc().selectedGroupInstance=t})("onChange",function(t){return r.yc(e),r.bc().getAllLessons(t)}),r.Pb(),r.Nb()}if(2&e){const e=r.bc();r.yb(1),r.ic("options",e.groupInstances)("ngModel",e.selectedGroupInstance)}}function S(e,t){if(1&e){const e=r.Rb();r.Ob(0),r.Qb(1,"span",17),r.Lb(2,"i",18),r.Pb(),r.Qb(3,"i",19),r.Xb("click",function(){r.yc(e);const t=r.bc().$implicit;return r.bc().show(t,"view")}),r.Pb(),r.Nb()}}function F(e,t){if(1&e){const e=r.Rb();r.Qb(0,"button",20),r.Xb("click",function(){r.yc(e);const t=r.bc().$implicit;return r.bc().show(t)}),r.Hc(1," Create Report "),r.Pb()}}function M(e,t){if(1&e&&(r.Qb(0,"div",10),r.Qb(1,"div",11),r.Qb(2,"div",12),r.Qb(3,"div",13),r.Qb(4,"h6",14),r.Hc(5),r.Pb(),r.Qb(6,"p"),r.Hc(7),r.cc(8,"date"),r.Pb(),r.Pb(),r.Lb(9,"div"),r.Pb(),r.Qb(10,"div",15),r.Fc(11,S,4,0,"ng-container",2),r.Fc(12,F,2,0,"button",16),r.Pb(),r.Pb(),r.Pb()),2&e){const e=t.$implicit;r.yb(5),r.Jc("Lesson ",null==e?null:e.serial,""),r.yb(2),r.Jc(" ",r.ec(8,4,null==e||null==e.lessonDefinition?null:e.lessonDefinition.createdDate,"MMM d y")," "),r.yb(4),r.ic("ngIf",e.submittedReport),r.yb(1),r.ic("ngIf",!e.submittedReport)}}function x(e,t){1&e&&(r.Qb(0,"span"),r.Hc(1,"Please select a group first"),r.Pb())}function H(e,t){1&e&&(r.Qb(0,"span"),r.Hc(1,"No Lessons yet for this group"),r.Pb())}function C(e,t){if(1&e&&(r.Qb(0,"div",21),r.Fc(1,x,2,0,"span",2),r.Fc(2,H,2,0,"span",2),r.Pb()),2&e){const e=r.bc();r.yb(1),r.ic("ngIf",e.selectedGroupInstance),r.yb(1),r.ic("ngIf",e.selectedGroupInstance)}}const T=[{path:"",component:(()=>{class e{constructor(e,t,o,s){this.dialogService=e,this.teacherService=t,this.authService=o,this.router=s,this.lessons=[],this.now=new Date,this.levels=[{label:"Level",value:""}],this.groupInstances=[{label:"Group Serial",value:""}],this.superVisorMode=!1,this.teacherGroupsFlag=!1}ngOnInit(){this.router.url.includes("supervisor")?this.superVisorMode=!0:this.authService.userData$.subscribe(e=>{this.userId=e.id,this.getTeacherGroupInstances()})}searchTeacher(e){const t=e.query;t&&this.teacherService.getAllTeacher({TeacherName:t,PageSize:1e4}).subscribe(e=>{var t;this.suggestedTeacher=e.data,null===(t=this.suggestedTeacher)||void 0===t||t.forEach(e=>{e.fullName=e.teacherFirstName+" "+e.teacherLastName})})}getTeacherGroup(e){this.teacherGroupsFlag=!0,this.getTeacherGroupInstances(e)}show(e,t){e.viewMode="view"==t,e.viewMode?this.teacherService.getLessonReportById({LessonInstanceId:e.id}).subscribe(t=>{e.report=t.data,this.openReportDialog(e)}):this.openReportDialog(e)}openReportDialog(e){this.dialogService.open(v,{showHeader:!1,width:"80%",data:{lesson:e}}).onClose.subscribe(t=>{t&&this.getAllLessons({value:e.groupInstance.id})})}getTeacherGroupInstances(e){this.teacherService.getAllGroupInstancesByTeacherId(e||this.userId).subscribe(e=>{e.data.forEach(e=>{this.groupInstances.push({value:e.groupInstanceId,label:e.groupInstance.serial})})})}getAllLessons(e){if(!e.value)return this.lessons=[];this.teacherService.getAllLessonInstancesByGroupInstance(e.value).subscribe(e=>{this.lessons=e.data})}}return e.\u0275fac=function(t){return new(t||e)(r.Kb(l.a),r.Kb(a.a),r.Kb(d.c),r.Kb(i.c))},e.\u0275cmp=r.Eb({type:e,selectors:[["app-lessons"]],features:[r.xb([a.a])],decls:10,vars:5,consts:[[1,"lessons","container"],[1,"mt-3"],[4,"ngIf"],[2,"display","flex"],[1,"row","mt-5","mb-5"],["class","col-lg-6 col-12 mb-4",4,"ngFor","ngForOf"],["class","col text-center text-danger",4,"ngIf"],[2,"margin-right","20px"],["name","teacherName","field","fullName",3,"ngModel","suggestions","dropdown","forceSelection","ngModelChange","completeMethod","onSelect"],[3,"options","ngModel","ngModelChange","onChange"],[1,"col-lg-6","col-12","mb-4"],[1,"align-items-center","d-flex","justify-content-between","p-3","lesson"],[1,"d-flex","flex-column"],[1,"align-items-baseline","d-flex"],[1,"mr-5","text-secondary"],[1,"d-flex"],["class","btn adler-btn pl-1 pr-1",3,"click",4,"ngIf"],[1,"Ellipse-13","rounded-circle"],[1,"fas","fa-check"],[1,"fas","fa-eye",3,"click"],[1,"btn","adler-btn","pl-1","pr-1",3,"click"],[1,"col","text-center","text-danger"]],template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"div",1),r.Fc(2,y,2,0,"label",2),r.Qb(3,"div",3),r.Fc(4,I,3,4,"ng-container",2),r.Qb(5,"div"),r.Fc(6,Q,2,2,"ng-container",2),r.Pb(),r.Pb(),r.Qb(7,"div",4),r.Fc(8,M,13,7,"div",5),r.Fc(9,C,3,2,"div",6),r.Pb(),r.Pb(),r.Pb()),2&e&&(r.yb(2),r.ic("ngIf",t.superVisorMode),r.yb(2),r.ic("ngIf",t.superVisorMode),r.yb(2),r.ic("ngIf",!t.superVisorMode||t.superVisorMode&&t.teacherGroupsFlag),r.yb(2),r.ic("ngForOf",t.lessons),r.yb(1),r.ic("ngIf",0==t.lessons.length))},directives:[s.m,s.l,P.a,c.p,c.s,k.a],pipes:[s.f],styles:[".Ellipse-13[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;margin:.063rem 1.068rem .148rem .525rem;padding:.625rem .625rem .563rem;border:2px solid #207a04;background-color:rgba(50,213,9,.55)}h5[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;font-stretch:normal;font-style:normal;line-height:4.46;letter-spacing:normal;text-align:left}.lesson[_ngcontent-%COMP%]{border-radius:16px;box-shadow:0 2px 4px 0 rgba(0,0,0,.16);border:1px solid var(--dark-blue-grey-16);background-color:#fafafa}.adler-btn[_ngcontent-%COMP%]{width:9rem}.fa-eye[_ngcontent-%COMP%]{margin-top:10px;font-size:17px;cursor:pointer}"]}),e})()},{path:"lesson-report",component:v}];let R=(()=>{class e{}return e.\u0275mod=r.Ib({type:e}),e.\u0275inj=r.Hb({factory:function(t){return new(t||e)},imports:[[i.g.forChild(T)],i.g]}),e})(),N=(()=>{class e{}return e.\u0275mod=r.Ib({type:e}),e.\u0275inj=r.Hb({factory:function(t){return new(t||e)},imports:[[s.c,R,n.a]]}),e})()}}]);